pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- kingz of wizardz
-- a spooky game jam game

---- constants ----

skeltal_sprs = {064, 065}

---- init ----

function _init()
  pl1 = new_player1()
  pl2 = new_player2()
  enemies = {}
  add(enemies, new_skeltal())
  add(enemies, new_skeltal())
  add(enemies, new_skeltal())
end

function new_player1()
  return {
    x = 10,
    y = 10,
    spr = 001,
    no = 0
  }
end

function new_player2()
  return {
    x = 100,
    y = 10,
    spr = 002,
    no = 1
  }
end

function new_skeltal()
  return {
    x = rnd(128),
    y = rnd(128),
    type = "skeltal",
    spr = 064
  }
end

---- update ----

function _update()
  update_player(pl1)
  update_player(pl2)
  foreach(enemies, update_entity)
end

function update_player(pl)
  if btn(0, pl.no) then
    pl.x = pl.x-1
  end
  if btn(1, pl.no) then
    pl.x = pl.x+1
  end
  if btn(2, pl.no) then
    pl.y = pl.y-1
  end
  if btn(3, pl.no) then
    pl.y = pl.y+1
  end
end

function update_entity(e)
  if e.type == "skeltal" then
    update_skeltal(e)
  end
end

function update_skeltal(s)
  if rnd(3) > 2 then
    s.x = s.x + rnd(3) - 1.5
    s.y = s.y + rnd(3) - 1.5
  end
end

---- draw ----

function _draw()
  cls()
  draw_entity(pl1)
  draw_entity(pl2)
  foreach(enemies, draw_entity)
  foreach(enemies, update_skeltal_spr)
end

function update_skeltal_spr(e)
  if e.spr == skeltal_sprs[1] then
    e.spr = skeltal_sprs[2]
  else
    e.spr = skeltal_sprs[1]
  end
end

function draw_entity(e)
  spr(e.spr, e.x, e.y)
end
__gfx__
00000000000000000ccccc000cccc0000cccc00090ffff00ccccc000cccccc000ccccc00000000000ccccc000ccccc0000000000000000000000000000000000
0000000008080000ccccccc000cccc0000cccc0040f1f100cccccc00ccccccc0ccccccc00ccccc00ccccccc0ccccccc000000000000000000000000000000000
0070070000000000c0f1f1000cccccc00cccccc040c66600c01ff1000cffffc0c6f1f1f6ccccccc0c0f1f1f0c6f1f1f600000000000000000000000000000000
0007700000000080c066660000f1f10000f1f1004cc666c000cccc000c1ff1c006efffe6c0c1ff1000efffe006efffe600000000000000000000000000000000
00077000880008800066660000f6660000ffff0040c66c0000cccc000cccccc00066666000cffff000cccc000066666000000000000000000000000000000000
00700700088888000cc66c0000c6660000cccc0040cc6c0000cccc000cccccc000f666f000ccccc000cccc0000c6660000000000000000000000000000000000
0000000000000000cccc6c0000cc6c0000cccc0040cccc0000cccc000cccccc000cc6c0000ccccc000cccc0000cc6c0000000000000000000000000000000000
0000000000000000ccccccc00ccccc0000c00c0040c00c0000c00c000c0000c00040040000400040004004000040040000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
78780000777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07770000787800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77770000777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77700000777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70700000707000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
011400000d0000d0000d0001000010000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
